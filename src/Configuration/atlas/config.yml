---
title: Configuration
description: Applies the Atlas configuration
privilege: TrustedInstaller
actions:
    # -------------------- Registry Portion --------------------

  - !writeStatus: {status: 'Modifying registry settings'}

    # Clear firewall rules
    # - !registryKey:
    # path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules'
    # - !registryKey:
    # path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules'
    # operation: add

    # Clear image file execution options
  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options'
  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options'
    operation: add

    # Crash Control QoL
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl'
    value: 'AutoReboot'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl'
    value: 'CrashDumpEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl'
    value: 'LogEvent'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl'
    value: 'DisplayParameters'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry'
    value: 'DeviceDumpEnabled'
    data: '0'
    type: REG_DWORD

    # Lock start menu layout and disable tiles
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer'
    value: 'StartLayoutFile'
    data: 'C:\Windows\layout.xml'
    type: REG_EXPAND_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer'
    value: 'LockedStartLayout'
    data: '1'
    type: REG_DWORD

    # Configure start menu settings
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'NoStartMenuMFUprogramsList'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer'
    value: 'HideRecentlyAddedApps'
    data: '1'
    type: REG_DWORD

    # Disable startup delay of running applications
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Serialize'
    value: 'StartupDelayInMSec'
    data: '0'
    type: REG_DWORD

    # Reduce menu show delay time
    # Automatically close any applications and continue to restart, shut down, or sign out of Windows
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'AutoEndTasks'
    data: '1'
    type: REG_SZ
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'MenuShowDelay'
    data: '0'
    type: REG_SZ

    # Decrease shutdown time
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'HungAppTimeout'
    data: '2000'
    type: REG_SZ
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'WaitToKillAppTimeOut'
    data: '2000'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control'
    value: 'WaitToKillServiceTimeout'
    data: '2000'
    type: REG_SZ

    # Enable dark mode and disable transparency
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize'
    value: 'SystemUsesLightTheme'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize'
    value: 'AppsUseLightTheme'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize'
    value: 'EnableTransparency'
    data: '0'
    type: REG_DWORD

    # Configure visual effect settings
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects'
    value: 'VisualFXSetting'
    data: '3'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'UserPreferencesMask'
    data: '9012038010000000'
    type: REG_BINARY

    # Disable desktop wallpaper import quality reduction
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'JPEGImportQuality'
    data: '100'
    type: REG_DWORD

    # Disable acrylic blur effect on sign-in screen background
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System'
    value: 'DisableAcrylicBackgroundOnLogon'
    data: '1'
    type: REG_DWORD

    # Disable animate windows when minimizing and maximizing
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop\WindowMetrics'
    value: 'MinAnimate'
    data: '0'
    type: REG_SZ

    # Disallow themes to changes desktop icons and mouse pointers
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes'
    value: 'ThemeChangesMousePointers'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes'
    value: 'ThemeChangesDesktopIcons'
    data: '0'
    type: REG_DWORD

    # Configure desktop window manager
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\DWM'
    value: 'Composition'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\DWM'
    value: 'EnableAeroPeek'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\DWM'
    value: 'EnableWindowColorization'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\DWM'
    value: 'DisallowAnimations'
    data: '1'
    type: REG_DWORD

    # Change tooltip color to blue
  - !registryValue:
    path: 'HKCU\Control Panel\Colors'
    value: 'InfoWindow'
    data: '246 253 255'
    type: REG_SZ

    # Disable the automatic download and installation of application updates
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\WindowsStore'
    value: 'AutoDownload'
    data: '2'
    type: REG_DWORD

    # Users can not add Microsoft accounts
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
    value: 'NoConnectedUser'
    data: '1'
    type: REG_DWORD

    # Disable fast user switching
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
    value: 'HideFastUserSwitching'
    data: '1'
    type: REG_DWORD

    # Disable website access to language list
  - !registryValue:
    path: 'HKCU\Control Panel\International\User Profile'
    value: 'HttpAcceptLanguageOptOut'
    data: '1'
    type: REG_DWORD

    # Disable automatic updates of the speech data
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Speech'
    value: 'AllowSpeechModelUpdate'
    data: '0'
    type: REG_DWORD

    # Disable online speech recognition
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Speech_OneCore\Settings\OnlineSpeechPrivacy'
    value: 'HasAccepted'
    data: '0'
    type: REG_DWORD

    # Disallow users to enable online speech recognition services
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\InputPersonalization'
    value: 'AllowInputPersonalization'
    data: '0'
    type: REG_DWORD

    # Disable Windows Insider and build previews
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds'
    value: 'AllowBuildPreview'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds'
    value: 'EnableConfigFlighting'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds'
    value: 'EnableExperimentation'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\WindowsSelfHost\UI\Visibility'
    value: 'HideInsiderPage'
    data: '1'
    type: REG_DWORD

    # Disable Windows Customer Experience Improvement Program (CEIP)
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\AppV\CEIP'
    value: 'CEIPEnable'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\SQMClient\Windows'
    value: 'CEIPEnable'
    data: '0'
    type: REG_DWORD

    # Disable switching to the Secure Desktop when prompting for elevation
    # As a note, UAC will not save you from well-made malware, UAC can easily be bypassed on Windows (check GitHub).
    # An application would need admin privileges to control the mouse and keyboard to accept the UAC prompt anyways.
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
    value: 'PromptOnSecureDesktop'
    data: '0'
    type: REG_DWORD

    # Disable activity feed
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System'
    value: 'EnableActivityFeed'
    data: '0'
    type: REG_DWORD

    # Prevent Windows Media DRM internet access
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\WMDRM'
    value: 'DisableOnline'
    data: '1'
    type: REG_DWORD

    # Disable Windows Media Player wizard on first run
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\MediaPlayer\Preferences'
    value: 'AcceptedPrivacyStatement'
    data: '1'
    type: REG_DWORD

    # Disable Windows Media Player diagnostics
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\MediaPlayer\Preferences'
    value: 'UsageTracking'
    data: '0'
    type: REG_DWORD

    # Disallow message service cloud sync
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Messaging'
    value: 'AllowMessageSync'
    data: '0'
    type: REG_DWORD

    # Configure search settings
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'BingSearchEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings'
    value: 'IsAADCloudSearchEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings'
    value: 'IsDeviceSearchHistoryEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings'
    value: 'IsMSACloudSearchEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings'
    value: 'SafeSearchMode'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'ConnectedSearchUseWeb'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'DisableWebSearch'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'EnableDynamicContentInWSB'
    data: '0'
    type: REG_DWORD

    # Disable search online and include web results from Bing
  - !registryValue:
    path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer'
    value: 'DisableSearchBoxSuggestions'
    data: '1'
    type: REG_DWORD

    # Set search as icon on taskbar
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'SearchboxTaskbarMode'
    data: '1'
    type: REG_DWORD

    # Disable Windows Ink workspace suggested applications
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\PenWorkspace'
    value: 'PenWorkspaceAppSuggestionsEnabled'
    data: '0'
    type: REG_DWORD

    # Configure File Explorer settings

    # Enable old alt tab
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'AltTabSettings'
    data: '1'
    type: REG_DWORD

    # Enable always show all icons and notifications on the taskbar
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'EnableAutoTray'
    data: '0'
    type: REG_DWORD

    # Fix context menu items missing when more than 15 files are selected
    # Set to 100 instead of 15
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'MultipleInvokePromptMinimum'
    data: '100'
    type: REG_DWORD

    # Hide frequently and recently used files/folders in Quick Access
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'ShowFrequent'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'ShowRecent'
    data: '0'
    type: REG_DWORD

    # Disable desktop peek
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'DisablePreviewDesktop'
    data: '1'
    type: REG_DWORD

    # Disable aero shake
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'DisallowShaking'
    data: '1'
    type: REG_DWORD

    # Show command prompt on win+x menu
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'DontUsePowerShellOnWinX'
    data: '1'
    type: REG_DWORD

    # Show hidden files, folders and drives in File Explorer
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'Hidden'
    data: '1'
    type: REG_DWORD

    # Show file extensions in File Explorer
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'HideFileExt'
    data: '0'
    type: REG_DWORD

    # Open File Explorer to 'This PC'
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'LaunchTo'
    data: '1'
    type: REG_DWORD

    # Set alt tab to open windows only
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'MultiTaskingAltTabFilter'
    data: '3'
    type: REG_DWORD

    # Disable sharing wizard
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'SharingWizardOn'
    data: '0'
    type: REG_DWORD

    # Hide sync provider notifications in File Explorer
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'ShowSyncProviderNotifications'
    data: '0'
    type: REG_DWORD

    # Configure snap settings
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'JointResize'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'SnapAssist'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'SnapFill'
    data: '0'
    type: REG_DWORD

    # Disable recent items and frequent places in File Explorer
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'Start_TrackDocs'
    data: '0'
    type: REG_DWORD

    # Disable app launch tracking
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'Start_TrackProgs'
    data: '0'
    type: REG_DWORD

    # Disable taskbar animations
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'TaskbarAnimations'
    data: '0'
    type: REG_DWORD

    # Hide badges on taskbar
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'TaskbarBadges'
    data: '0'
    type: REG_DWORD

    # Show more details in file transfer dialog
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\OperationStatusManager'
    value: 'EnthusiastMode'
    data: '1'
    type: REG_DWORD

    # Clear history of recently opened documents on exit
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'ClearRecentDocsOnExit'
    data: '1'
    type: REG_DWORD

    # Disable user tracking
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'NoInstrumentation'
    data: '1'
    type: REG_DWORD

    # Disable low disk space warning
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'NoLowDiskSpaceChecks'
    data: '1'
    type: REG_DWORD

    # Do not keep history of recently opened documents
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'NoRecentDocsHistory'
    data: '1'
    type: REG_DWORD

    # Do not use the search-based method when resolving shell shortcuts
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'NoResolveSearch'
    data: '1'
    type: REG_DWORD

    # Do not use the tracking-based method when resolving shell shortcuts
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'NoResolveTrack'
    data: '1'
    type: REG_DWORD

    # Disallow pinning Microsoft Store app to taskbar
  - !registryValue:
    path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer'
    value: 'NoPinningStoreToTaskbar'
    data: '1'
    type: REG_DWORD

    # Do not display or track items in jump lists from remote locations
  - !registryValue:
    path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer'
    value: 'NoRemoteDestinations'
    data: '1'
    type: REG_DWORD

    # Disable internet file association service
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'NoInternetOpenWith'
    data: '1'
    type: REG_DWORD

    # Extend icon cache size to 4 MB
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'Max Cached Icons'
    data: '4096'
    type: REG_SZ

    # Disable automatic folder type discovery
  - !registryKey:
    path: 'HKCU\SOFTWARE\Classes\Local Settings\Software\Microsoft\Windows\Shell\BagMRU'
  - !registryKey:
    path: 'HKCU\SOFTWARE\Classes\Local Settings\Software\Microsoft\Windows\Shell\Bags'
  - !registryValue:
    path: 'HKCU\SOFTWARE\Classes\Local Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell'
    value: 'FolderType'
    data: 'NotSpecified'
    type: REG_SZ

    # Disable Content Delivery Manager
    # Disable pre-installed applications
    # Disable Windows welcome experience
    # Disable suggested content in Immersive Control Panel
    # Disable fun facts, tips, tricks on Windows Spotlight
    # Disable start menu suggestions
    # Disable get tips, tricks, and suggestions as you use Windows
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'ContentDeliveryAllowed'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'OemPreInstalledAppsEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'PreInstalledAppsEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'PreInstalledAppsEverEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SilentInstalledAppsEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SubscribedContent-310093Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SubscribedContent-338393Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SubscribedContent-353694Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SubscribedContent-353696Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SubscribedContent-338387Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'RotatingLockScreenOverlayEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SubscribedContent-338388Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SystemPaneSuggestionsEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SubscribedContent-338389Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager'
    value: 'SoftLandingEnabled'
    data: '0'
    type: REG_DWORD

    # Disable tips in Immersive Control Panel
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\PolicyManager\default\Settings\AllowOnlineTips'
    value: 'value'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'AllowOnlineTips'
    data: '0'
    type: REG_DWORD

    # Disable Windows Spotlight features
  - !registryValue:
    path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
    value: 'DisableWindowsSpotlightFeatures'
    data: '1'
    type: REG_DWORD

    # Do not suggest third-party content in Windows Spotlight
  - !registryValue:
    path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
    value: 'DisableThirdPartySuggestions'
    data: '1'
    type: REG_DWORD

    # Do not use diagnostic data for tailored experiences
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy'
    value: 'TailoredExperiencesWithDiagnosticDataEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
    value: 'DisableTailoredExperiencesWithDiagnosticData'
    data: '1'
    type: REG_DWORD

    # Disable cloud optimized content
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent'
    value: 'DisableCloudOptimizedContent'
    data: '1'
    type: REG_DWORD

    # Disable suggest ways I can finish setting up my device
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\UserProfileEngagement'
    value: 'ScoobeSystemSettingEnabled'
    data: '0'
    type: REG_DWORD

    # Disable use sign-in info to auto finish setting up device after update or restart
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System'
    value: 'DisableAutomaticRestartSignOn'
    data: '1'
    type: REG_DWORD

    # Disable Program Compatibility Assistant (PCA)
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat'
    value: 'AITEnable'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat'
    value: 'AllowTelemetry'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat'
    value: 'DisableEngine'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat'
    value: 'DisableInventory'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat'
    value: 'DisablePCA'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat'
    value: 'DisableUAR'
    data: '1'
    type: REG_DWORD

    # Never use tablet mode
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell'
    value: 'SignInMode'
    data: '1'
    type: REG_DWORD

    # Disable 'Open file' - security warning message
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3'
    value: '1806'
    data: '0'
    type: REG_DWORD

    # Do not preserve zone information in file attachments
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Attachments'
    value: 'SaveZoneInformation'
    data: '1'
    type: REG_DWORD

    # Disable enhance pointer precision
  - !registryValue:
    path: 'HKCU\Control Panel\Mouse'
    value: 'MouseSpeed'
    data: '0'
    type: REG_SZ
  - !registryValue:
    path: 'HKCU\Control Panel\Mouse'
    value: 'MouseThreshold1'
    data: '0'
    type: REG_SZ
  - !registryValue:
    path: 'HKCU\Control Panel\Mouse'
    value: 'MouseThreshold2'
    data: '0'
    type: REG_SZ

    # Reduce mouse hover time to 20 milliseconds
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'MouseHoverTime'
    data: '20'
    type: REG_SZ

    # Configure Ease of Access settings

    # Disable always read and scan this section in ease of access
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Ease of Access'
    value: 'selfscan'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Ease of Access'
    value: 'selfvoice'
    data: '0'
    type: REG_DWORD

    # Disable warning sounds and sound on activation in ease of access
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility'
    value: 'Warning Sounds'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility'
    value: 'Sound on Activation'
    data: '0'
    type: REG_DWORD

    # Disable visual warning for sounds in ease of access
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility\SoundSentry'
    value: 'WindowsEffect'
    data: '0'
    type: REG_SZ

    # Disable make touch and tablets easier to use in ease of access
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility\SlateLaunch'
    value: 'LaunchAT'
    data: '0'
    type: REG_DWORD

    # Disable annoying keyboard and mouse features
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility\HighContrast'
    value: 'Flags'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility\Keyboard Response'
    value: 'Flags'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility\MouseKeys'
    value: 'Flags'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility\StickyKeys'
    value: 'Flags'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\Control Panel\Accessibility\ToggleKeys'
    value: 'Flags'
    data: '0'
    type: REG_DWORD

    # Disable touch visual feedback
  - !registryValue:
    path: 'HKCU\Control Panel\Cursors'
    value: 'GestureVisualization'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\Control Panel\Cursors'
    value: 'ContactVisualization'
    data: '0'
    type: REG_DWORD

    # Disable text/ink/handwriting telemetry
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\InputPersonalization'
    value: 'RestrictImplicitInkCollection'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\InputPersonalization'
    value: 'RestrictImplicitTextCollection'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore'
    value: 'HarvestContacts'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Personalization\Settings'
    value: 'AcceptedPrivacyPolicy'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\TabletPC'
    value: 'PreventHandwritingDataSharing'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports'
    value: 'PreventHandwritingErrorReports'
    data: '1'
    type: REG_DWORD

    # Disable spell checking
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\TabletTip\1.7'
    value: 'EnableAutocorrection'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\TabletTip\1.7'
    value: 'EnableDoubleTapSpace'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\TabletTip\1.7'
    value: 'EnablePredictionSpaceInsertion'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\TabletTip\1.7'
    value: 'EnableSpellchecking'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\TabletTip\1.7'
    value: 'EnableTextPrediction'
    data: '0'
    type: REG_DWORD

    # Disable typing insights
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Input\Settings'
    value: 'InsightsEnabled'
    data: '0'
    type: REG_DWORD

    # Disable Resultant Set of Policy (RSoP) logging
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System'
    value: 'RSoPLogging'
    data: '0'
    type: REG_DWORD

    # Disable Windows Error Reporting (WER)
    # https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.InternetCommunicationManagement::PCH_DoNotReport
  - !registryValue:
    path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting'
    value: 'Disabled'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\PCHealth\ErrorReporting'
    value: 'DoReport'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting'
    value: 'Disabled'
    data: '1'
    type: REG_DWORD

    # Disallow telemetry/data collection
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Diagnostics\DiagTrack'
    value: 'ShowedToastAtLevel'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection'
    value: 'AllowTelemetry'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection'
    value: 'MaxTelemetryAllowed'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Policies\DataCollection'
    value: 'AllowTelemetry'
    data: '0'
    type: REG_DWORD

  # Disable Diagnostic Tracking
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\Diagnostics\Performance'
    value: 'DisableDiagnosticTracing'
    data: '1'
    type: REG_DWORD

  # Configure app permissions/privacy section in Immersive Control Panel
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appointments'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetoothSync'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\broadFileSystemAccess'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\documentsLibrary'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\email'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCall'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCallHistory'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\picturesLibrary'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userAccountInformation'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userNotificationListener'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\videosLibrary'
    value: 'Value'
    data: 'Deny'
    type: REG_SZ

    # Disable SmartScreen for Microsoft Store applications
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost'
    value: 'EnableWebContentEvaluation'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost'
    value: 'PreventOverride'
    data: '0'
    type: REG_DWORD

    # Disable SmartScreen for applications and files from web
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System'
    value: 'EnableSmartScreen'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'SmartScreenEnabled'
    data: 'Off'
    type: REG_SZ

    # Disable experimentation
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\PolicyManager\default\System\AllowExperimentation'
    value: 'Value'
    data: '0'
    type: REG_DWORD

    # Disable improve inking and typing recognition
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Input\TIPC'
    value: 'Enabled'
    data: '0'
    type: REG_DWORD

    # Disallow upload and publish of user activities
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System'
    value: 'UploadUserActivities'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System'
    value: 'PublishUserActivities'
    data: '0'
    type: REG_DWORD

    # Disable Performance Track (PerfTrack)
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d}'
    value: 'ScenarioExecutionEnabled'
    data: '0'
    type: REG_DWORD

    # Disable advertising info
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo'
    value: 'Enabled'
    data: '0'
    type: REG_DWORD

    # Disable Bluetooth advertising
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Bluetooth'
    value: 'AllowAdvertising'
    data: '0'
    type: REG_DWORD

    # Disable KMS client online AVS validation
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform'
    value: 'NoGenTicket'
    data: '1'
    type: REG_DWORD

    # Disable Windows Feedback
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Siuf\Rules'
    value: 'NumberOfSIUFInPeriod'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Siuf\Rules'
    value: 'PeriodInNanoSeconds'
    operation: delete
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection'
    value: 'DoNotShowFeedbackNotifications'
    data: '1'
    type: REG_DWORD

    # Disable setting synchronization
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync'
    value: 'DisableSettingSync'
    data: '2'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync'
    value: 'DisableSettingSyncUserOverride'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync'
    value: 'DisableSyncOnPaidNetwork'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Personalization'
    value: 'Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\BrowserSettings'
    value: 'Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Credentials'
    value: 'Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Accessibility'
    value: 'Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Windows'
    value: 'Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync'
    value: 'SyncPolicy'
    data: '5'
    type: REG_DWORD

    # Disable location tracking
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\FindMyDevice'
    value: 'AllowFindMyDevice'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\FindMyDevice'
    value: 'LocationSyncEnabled'
    data: '0'
    type: REG_DWORD

    # Hide meet now button on taskbar
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'HideSCAMeetNow'
    data: '1'
    type: REG_DWORD

    # Hide task view button on taskbar
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MultiTaskingView\AllUpView'
    value: 'Enabled'
    operation: delete
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'ShowTaskViewButton'
    data: '0'
    type: REG_DWORD

    # Disable news and interests on taskbar
    # Explorer immediately reset ShellFeedsTaskbarViewMode otherwise
  - !taskKill:
    name: 'explorer'
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds'
    value: 'ShellFeedsTaskbarViewMode'
    data: '2'
    type: REG_DWORD
    operation: add
  - !run:
    exe: 'explorer.exe'
    wait: false

    # Disable Shared Experiences
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System'
    value: 'EnableCdp'
    data: '0'
    type: REG_DWORD

    # Show all tasks in Control Panel
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}'
    data: 'All Tasks'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}'
    value: 'InfoTip'
    data: 'View list of all Control Panel tasks'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}'
    value: 'System.ControlPanel.Category'
    data: '5'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}\DefaultIcon'
    data: 'C:\Windows\System32\imageres.dll,-27'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Classes\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}\Shell\Open\Command'
    data: 'explorer.exe shell:::{ED7BA470-8E54-465E-825C-99712043E01C}'
    type: REG_SZ
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel\NameSpace\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}'
    data: 'All Tasks'
    type: REG_SZ

    # Configure paging settings
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management'
    value: 'DisablePagingExecutive'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management'
    value: 'DisablePageCombining'
    data: '1'
    type: REG_DWORD

    # Set System Responsiveness to 10
    # https://learn.microsoft.com/en-us/windows/win32/procthread/multimedia-class-scheduler-service#registry-settings
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile'
    value: 'SystemResponsiveness'
    data: '10'
    type: REG_DWORD

    # Disable Game Bar and Full Screen Optimizations (FSO)
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\GameBar'
    value: 'GamePanelStartupTipIndex'
    data: '3'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\GameBar'
    value: 'ShowStartupPanel'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\GameBar'
    value: 'UseNexusForGameBarEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\System\GameConfigStore'
    value: 'GameDVR_Enabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\System\GameConfigStore'
    value: 'GameDVR_FSEBehaviorMode'
    data: '2'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\System\GameConfigStore'
    value: 'GameDVR_FSEBehavior'
    data: '2'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\System\GameConfigStore'
    value: 'GameDVR_HonorUserFSEBehaviorMode'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\System\GameConfigStore'
    value: 'GameDVR_DXGIHonorFSEWindowsCompatible'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\System\GameConfigStore'
    value: 'GameDVR_EFSEFeatureFlags'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\System\GameConfigStore'
    value: 'GameDVR_DSEBehavior'
    data: '2'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR'
    value: 'AppCaptureEnabled'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR'
    value: 'AllowGameDVR'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\PolicyManager\default\ApplicationManagement\AllowGameDVR'
    value: 'value'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment'
    value: '__COMPAT_LAYER'
    data: '~ DISABLEDXMAXIMIZEDWINDOWEDMODE'
    type: REG_SZ

    # Disable Game Mode
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\GameBar'
    value: 'AllowAutoGameMode'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\GameBar'
    value: 'AutoGameModeEnabled'
    data: '0'
    type: REG_DWORD

    # Do not let applications run in the background
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications'
    value: 'GlobalUserDisabled'
    data: '1'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'BackgroundAppGlobalToggle'
    data: '0'
    type: REG_DWORD

    # Set Win32PrioritySeparation
    # Short Quantum, Variable, High foreground boost
    # 26 hexadecimal | 38 decimal (default: Programs)
  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control\PriorityControl'
    value: 'Win32PrioritySeparation'
    data: '38'
    type: REG_DWORD

    # Disable lockscreen
  - !registryValue:
    path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\LogonUI\SessionData'
    value: 'AllowLockScreen'
    data: '0'
    type: REG_DWORD

    # Disable notify about USB issues
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Shell\USB'
    value: 'NotifyOnUsbErrors'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Shell\USB'
    value: 'NotifyOnWeakCharger'
    data: '0'
    type: REG_DWORD




    # Disable Game Bar Presence Writer
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\WindowsRuntime\ActivatableClassId\Windows.Gaming.GameBar.PresenceServer.Internal.PresenceWriter'
    value: 'ActivationType'
    data: '0'
    type: REG_DWORD

    # Disable automatic maintenance
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance'
    value: 'MaintenanceDisabled'
    data: '1'
    type: REG_DWORD

    # Disable scheduled system maintenance
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\ScheduledDiagnostics'
    value: 'EnabledExecution'
    data: '0'
    type: REG_DWORD

    # Do not reduce sounds while in a call
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Multimedia\Audio'
    value: 'UserDuckingPreference'
    data: '3'
    type: REG_DWORD

    # Do not show hidden and disconnected devices in mmsys.cpl
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Multimedia\Audio\DeviceCpl'
    value: 'ShowDisconnectedDevices'
    data: '0'
    type: REG_DWORD
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Multimedia\Audio\DeviceCpl'
    value: 'ShowHiddenDevices'
    data: '0'
    type: REG_DWORD

    # Show removable drivers only in 'This PC' on the file explorer sidebar
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\DelegateFolders\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}'}
  - !registryKey: {path: 'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\DelegateFolders\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}'}

    # Remove network navigation pane from File Explorer
  - !registryValue:
    path: 'HKCR\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}\ShellFolder'
    value: 'Attributes'
    data: '2962489444'
    type: REG_DWORD

    # Remove 'Restore previous versions' from context menu and file' properties
  - !registryKey: {path: 'HKCR\AllFilesystemObjects\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\CLSID\{450D8FBA-AD25-11D0-98A8-0800361B1103}\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Directory\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Drive\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\AllFilesystemObjects\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\CLSID\{450D8FBA-AD25-11D0-98A8-0800361B1103}\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Directory\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Drive\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer', value: 'NoPreviousVersionsPage', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\PreviousVersions', value: 'DisableLocalPage', operation: delete}



    # Remove '- Shortcut' text added onto shortcuts
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'link'
    data: '00000000'
    type: REG_BINARY

    # Remove shortcut icon
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Icons'
    value: '29'
    data: 'C:\Windows\AtlasModules\Other\Blank.ico,0'
    type: REG_SZ







    # ------------------ Registry Portion END ------------------

    # Prevent Microsoft Edge (Chromium) from installing after updates
    # For future Windows Update support
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\EdgeUpdate', value: 'DoNotUpdateToEdgeWithChromium', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\EdgeUpdate', value: 'Install{56EB18F8-B008-4CBD-B6D2-8C97FE7E9062}', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\EdgeUpdate', value: 'Install{F3017226-FE2A-4295-8BDF-00C3A9A7E4C5}', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\EdgeUpdate', value: 'InstallDefault', type: REG_DWORD, data: '0'}

    # Fix no downloads folder bug
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{088e3905-0323-4b02-9826-5d99428e115f}', operation: add}

    # Remove SecurityHealthSystray startup item
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run', value: 'SecurityHealth', operation: delete}

  - !writeStatus: {status: 'Changing boot manager options'}
    # https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/bcdedit

    # Set dual boot menu description to Atlas
  - !run: {exe: 'bcdedit', args: '/set description "Atlas 22H2"'}

    # Lowering dual boot choice time
    # This does not affect single OS boot time
    # https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/--timeout#parameters
  - !run: {exe: 'bcdedit', args: '/timeout 10'}

    # Setting to "no" provides worse results, delete the value instead.
    # This is here as a safeguard in case of user error
  - !run: {exe: 'bcdedit', args: '/deletevalue useplatformclock'}

    # Disable dynamic tick
    # https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set#additional-settings
  - !run: {exe: 'bcdedit', args: '/set disabledynamictick yes'}

    # Use legacy boot menu
  - !run: {exe: 'bcdedit', args: '/set bootmenupolicy Legacy'}

  - !writeStatus:  {status: 'Setting power options'}
  - !run:
    exeDir: true
    exe: 'POWER.cmd'
    weight: 20

  - !writeStatus: {status: 'Cleaning start menu'}
  - !run:
    exeDir: true
    exe: 'STARTMENU.cmd'
    weight: 20

  - !writeStatus: {status: 'Setting wallpapers'}
  - !run:
    exeDir: true
    exe: 'WALLPAPER.cmd'
    weight: 20

  - !writeStatus: {status: 'Setting profile pictures'}
  - !run:
    exeDir: true
    exe: 'PFP.cmd'
    weight: 20

  - !writeStatus: {status: 'Finalizing configuration'}
  - !run:
    exeDir: true
    exe: 'FINALIZE.cmd'
    weight: 100

    # Backup Atlas services & drivers after all modifications
  - !run: {exe: 'BACKUP2.cmd', exeDir: true}

  - !writeStatus: {status: "Cleaning up temp files & WinSxS"}
  - !cmd:
    exeDir: true
    command: 'DISM /Online /Cleanup-Image /StartComponentCleanup'
    weight: 30

    # Clean up temp folders and files
    # Cleanmgr does not clean these up as AME needs to be prevented from being deleted
  - !cmd:
    command: 'for /f %a in (''dir /b "%TEMP%" /a:-d'') do del /q "%TEMP%\%a"'
    weight: 10
    # Windows Temp folder
  - !cmd:
    command: 'del /f /s /q C:\Windows\Temp\*'
    weight: 10
    # The AME folder has to be excluded here, otherwise it will remove
    # the Playbook logs and cause issues with the AME Wizard
  - !cmd:
    command: 'for /f %a in (''dir /b "%TEMP%" /a:d ^| findstr /v /c:"AME"'') do rmdir /q /s "%TEMP%\%a"'
    weight: 10
