---
title: Initial Configuration
description: Copies Atlas folders/files, installs dependencies and performs the preliminary configuration
privilege: TrustedInstaller
actions:
    # AME Wizard Live Log For Development Playbooks
  - !run: {exe: 'cmd.exe', args: '/c start "AME Wizard Live Log" powershell.exe -NoProfile -Command "Get-Content -wait Logs\AdminOutput.txt -ErrorAction SilentlyContinue | Write-Output; pause"', baseDir: true, wait: false, showError: true}
  
    # Prevent annoying notifications during deployment
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Windows.SystemToast.SecurityAndMaintenance', value: 'Enabled', type: REG_DWORD, data: '0'}
 
  - !writeStatus: {status: 'Copying files'}
  - !cmd:
    exeDir: true
    command: 'robocopy "Screen" "%windir%\Web\Screen" /E /PURGE /IM /IT /NP > nul'
    weight: 10
  - !cmd:
    exeDir: true
    command: 'robocopy "User Account Pictures" "%programdata%\Microsoft\User Account Pictures" /E /PURGE /IM /IT /NP > nul'
    weight: 10
  - !cmd:
    exeDir: true
    command: 'robocopy "AtlasModules" "%windir%\AtlasModules" /E /PURGE /IM /IT /NP > nul'
    weight: 10
  - !cmd:
    exeDir: true
    command: 'robocopy "AtlasDesktop" "%windir%\AtlasDesktop" /E /PURGE /IM /IT /NP > nul'
    weight: 10

  - !writeStatus: {status: 'Setting the environment'}
  - !cmd: {command: 'setx path "%PATH%;%windir%\AtlasModules;%windir%\AtlasModules\Apps;%windir%\AtlasModules\Other;%windir%\AtlasModules\Tools;%windir%\AtlasModules\Scripts" -m'}
  - !cmd: {command: 'setx psmodulepath "%psmodulepath%;%windir%\AtlasModules\Scripts\Modules" -m'}

    # Does not supported in AME as of now
  # - !writeStatus: {status: 'Refreshing variables'}
  # - !run: {exeDir: true, exe: 'REFRESHENV.cmd'}

  - !writeStatus: {status: 'Cleaning the component store'}
  - !run: {exe: 'DISM.exe', args: '/Online /Cleanup-Image /StartComponentCleanup', weight: 150}

  - !writeStatus: {status: 'Configuring Optional Features'}
    # Enabled for compatibility purposes
  - !run: {exe: 'DISM.exe', args: '/Online /Enable-Feature /FeatureName:"LegacyComponents" /NoRestart', weight: 30}
  - !run: {exe: 'DISM.exe', args: '/Online /Enable-Feature /FeatureName:"DirectPlay" /NoRestart', weight: 30}
    # Disabled for security purposes
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Internet-Explorer-Optional-amd64" /NoRestart', weight: 30}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"MicrosoftWindowsPowerShellV2" /NoRestart', weight: 30}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"MicrosoftWindowsPowerShellV2Root" /NoRestart', weight: 30}
    # Disabled by default? https://learn.microsoft.com/en-us/dotnet/framework/wcf/feature-details/how-to-enable-the-net-tcp-port-sharing-service
  # - !run: {command: 'DISM /Online /Disable-Feature /FeatureName:"WCF-TCP-PortSharing45" /NoRestart', weight: 30}
    # Printing is disalbed by default 
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Printing-Foundation-Features" /NoRestart', weight: 30}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Printing-Foundation-InternetPrinting-Client" /NoRestart', weight: 30}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Printing-XPSServices-Features" /NoRestart', weight: 30}
    # Seems pointless to disable, unused by default https://learn.microsoft.com/en-us/windows-server/storage/work-folders/work-folders-overview
  # - !run: {command: 'DISM /Online /Disable-Feature /FeatureName:"WorkFolders-Client" /NoRestart', weight: 30}
  
    # For an unknown reason, .NET 3.5 has to be enabled last or DISM breaks
  - !run: {exe: 'DISM.exe', args: '/Online /Enable-Feature /FeatureName:"NetFx3" /NoRestart', weight: 30}

  ################ NO LOCAL BUILD ################

  - !writeStatus: {status: 'Installing dependencies'}
    # NSudo will start PowerShell in AtlasModules, so the exeDir option doesn't work
  - !cmd: {exeDir: true, command: 'copy /y "WINGET.PS1" "C:\Windows\Temp\WINGET.ps1"'}
  - !run:
    exe: 'C:\Windows\AtlasModules\Tools\NSudoLC.exe'
    args: '-U:E -UseCurrentConsole -Wait powershell.exe -NoP -File "C:\Windows\Temp\WINGET.ps1"'
    wait: true
    weight: 150

  - !writeStatus: {status: 'Installing LibreWolf', option: 'browser-librewolf'}
  - !run:
    exe: 'C:\Windows\AtlasModules\Tools\NSudoLC.exe'
    args: '-U:E -UseCurrentConsole -Wait winget install -e --id LibreWolf.LibreWolf --accept-package-agreements --accept-source-agreements --disable-interactivity --force -h --ignore-local-archive-malware-scan --ignore-security-hash'
    wait: true
    option: 'librewolf-winget'
    weight: 150
  - !run:
    exe: 'powershell.exe'
    args: '-NoP -File LIBREWOLF.ps1'
    exeDir: true
    wait: true
    option: 'librewolf-winupdater'

  - !writeStatus: {status: 'Installing Google Chrome', option: 'browser-chrome'}
  - !run:
    exe: 'C:\Windows\AtlasModules\Tools\NSudoLC.exe'
    args: '-U:E -UseCurrentConsole -Wait winget install -e --id Google.Chrome --accept-package-agreements --accept-source-agreements --disable-interactivity --force -h --ignore-local-archive-malware-scan --ignore-security-hash'
    wait: true
    option: 'browser-chrome'
    weight: 150

  - !writeStatus: {status: 'Installing Brave', option: 'browser-brave'}
  - !run:
    exe: 'C:\Windows\AtlasModules\Tools\NSudoLC.exe'
    args: '-U:E -UseCurrentConsole -Wait winget install -e --id Brave.Brave --accept-package-agreements --accept-source-agreements --disable-interactivity --force -h --ignore-local-archive-malware-scan --ignore-security-hash'
    wait: true
    option: 'browser-brave'
    weight: 150

    # Revert temporary WinGet configuration
  - !run:
    exe: 'C:\Windows\AtlasModules\Tools\NSudoLC.exe'
    args: '-U:E -UseCurrentConsole -Wait winget settings --disable InstallerHashOverride'
  - !run:
    exe: 'C:\Windows\AtlasModules\Tools\NSudoLC.exe'
    args: '-U:E -UseCurrentConsole -Wait winget settings --disable LocalArchiveMalwareScanOverride'

  - !writeStatus: {status: 'Configuring 7-Zip'}
  - !registryValue: {path: 'HKCU\SOFTWARE\7-Zip\FM\Columns', value: 'RootFolder', data: '0100000000000000010000000400000001000000A0000000', type: REG_BINARY}
  - !registryValue: {path: 'HKCU\SOFTWARE\7-Zip\Options', value: 'ContextMenu', data: '548', type: REG_DWORD}
  - !registryValue: {path: 'HKCU\SOFTWARE\7-Zip\Options', value: 'ElimDupExtract', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.001', value: '', data: '7-Zip.001', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.7z', value: '', data: '7-Zip.7z', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.apfs', value: '', data: '7-Zip.apfs', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.arj', value: '', data: '7-Zip.arj', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.bz2', value: '', data: '7-Zip.bz2', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.bzip2', value: '', data: '7-Zip.bzip2', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.cab', value: '', data: '7-Zip.cab', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.cpio', value: '', data: '7-Zip.cpio', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.deb', value: '', data: '7-Zip.deb', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.dmg', value: '', data: '7-Zip.dmg', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.esd', value: '', data: '7-Zip.esd', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.fat', value: '', data: '7-Zip.fat', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.gz', value: '', data: '7-Zip.gz', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.gzip', value: '', data: '7-Zip.gzip', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.hfs', value: '', data: '7-Zip.hfs', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.iso', value: '', data: '7-Zip.iso', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.lha', value: '', data: '7-Zip.lha', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.lzh', value: '', data: '7-Zip.lzh', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.lzma', value: '', data: '7-Zip.lzma', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.ntfs', value: '', data: '7-Zip.ntfs', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.rar', value: '', data: '7-Zip.rar', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.rpm', value: '', data: '7-Zip.rpm', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.squashfs', value: '', data: '7-Zip.squashfs', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.swm', value: '', data: '7-Zip.swm', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.tar', value: '', data: '7-Zip.tar', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.taz', value: '', data: '7-Zip.taz', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.tbz', value: '', data: '7-Zip.tbz', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.tbz2', value: '', data: '7-Zip.tbz2', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.tgz', value: '', data: '7-Zip.tgz', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.tpz', value: '', data: '7-Zip.tpz', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.txz', value: '', data: '7-Zip.txz', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.vhd', value: '', data: '7-Zip.vhd', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.vhdx', value: '', data: '7-Zip.vhdx', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.wim', value: '', data: '7-Zip.wim', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.xar', value: '', data: '7-Zip.xar', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.xz', value: '', data: '7-Zip.xz', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.z', value: '', data: '7-Zip.z', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.zip', value: '', data: '7-Zip.zip', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.001', value: '', data: '001 Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.001\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,9', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.001\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.7z', value: '', data: '7z Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.7z\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,0', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.7z\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.apfs', value: '', data: 'apfs Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.apfs\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,25', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.apfs\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.arj', value: '', data: 'arj Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.arj\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,4', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.arj\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.bz2', value: '', data: 'bz2 Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.bz2\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,2', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.bz2\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.bzip2', value: '', data: 'bzip2 Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.bzip2\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,2', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.bzip2\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.cab', value: '', data: 'cab Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.cab\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,7', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.cab\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.cpio', value: '', data: 'cpio Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.cpio\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,12', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.cpio\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.deb', value: '', data: 'deb Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.deb\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,11', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.deb\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.dmg', value: '', data: 'dmg Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.dmg\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,17', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.dmg\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.esd', value: '', data: 'esd Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.esd\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,15', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.esd\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.fat', value: '', data: 'fat Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.fat\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,21', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.fat\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.gz', value: '', data: 'gz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.gz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,14', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.gz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.gzip', value: '', data: 'gzip Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.gzip\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,14', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.gzip\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.hfs', value: '', data: 'hfs Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.hfs\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,18', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.hfs\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.iso', value: '', data: 'iso Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.iso\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,8', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.iso\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lha', value: '', data: 'lha Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lha\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,6', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lha\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lzh', value: '', data: 'lzh Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lzh\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,6', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lzh\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lzma', value: '', data: 'lzma Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lzma\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,16', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.lzma\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.ntfs', value: '', data: 'ntfs Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.ntfs\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,22', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.ntfs\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.rar', value: '', data: 'rar Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.rar\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,3', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.rar\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.rpm', value: '', data: 'rpm Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.rpm\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,10', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.rpm\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.squashfs', value: '', data: 'squashfs Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.squashfs\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,24', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.squashfs\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.swm', value: '', data: 'swm Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.swm\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,15', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.swm\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tar', value: '', data: 'tar Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tar\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,13', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tar\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.taz', value: '', data: 'taz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.taz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,5', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.taz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tbz', value: '', data: 'tbz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tbz2', value: '', data: 'tbz2 Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tbz2\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,2', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tbz2\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tbz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,2', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tbz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tgz', value: '', data: 'tgz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tgz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,14', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tgz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tpz', value: '', data: 'tpz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tpz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,14', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.tpz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.txz', value: '', data: 'txz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.txz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,23', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.txz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.vhd', value: '', data: 'vhd Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.vhd\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,20', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.vhd\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.vhdx', value: '', data: 'vhdx Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.vhdx\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,20', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.vhdx\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.wim', value: '', data: 'wim Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.wim\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,15', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.wim\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.xar', value: '', data: 'xar Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.xar\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,19', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.xar\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.xz', value: '', data: 'xz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.xz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,23', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.xz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.z', value: '', data: 'z Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.z\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,5', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.z\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.zip', value: '', data: 'zip Archive', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.zip\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,1', type: REG_SZ}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\7-Zip.zip\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.001', value: '', data: '7-Zip.001', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.7z', value: '', data: '7-Zip.7z', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.apfs', value: '', data: '7-Zip.apfs', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.arj', value: '', data: '7-Zip.arj', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.bz2', value: '', data: '7-Zip.bz2', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.bzip2', value: '', data: '7-Zip.bzip2', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.cab', value: '', data: '7-Zip.cab', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.cpio', value: '', data: '7-Zip.cpio', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.deb', value: '', data: '7-Zip.deb', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.dmg', value: '', data: '7-Zip.dmg', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.esd', value: '', data: '7-Zip.esd', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.fat', value: '', data: '7-Zip.fat', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.gz', value: '', data: '7-Zip.gz', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.gzip', value: '', data: '7-Zip.gzip', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.hfs', value: '', data: '7-Zip.hfs', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.iso', value: '', data: '7-Zip.iso', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.lha', value: '', data: '7-Zip.lha', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.lzh', value: '', data: '7-Zip.lzh', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.lzma', value: '', data: '7-Zip.lzma', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.ntfs', value: '', data: '7-Zip.ntfs', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.rar', value: '', data: '7-Zip.rar', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.rpm', value: '', data: '7-Zip.rpm', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.squashfs', value: '', data: '7-Zip.squashfs', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.swm', value: '', data: '7-Zip.swm', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.tar', value: '', data: '7-Zip.tar', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.taz', value: '', data: '7-Zip.taz', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.tbz', value: '', data: '7-Zip.tbz', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.tbz2', value: '', data: '7-Zip.tbz2', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.tgz', value: '', data: '7-Zip.tgz', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.tpz', value: '', data: '7-Zip.tpz', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.txz', value: '', data: '7-Zip.txz', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.vhd', value: '', data: '7-Zip.vhd', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.vhdx', value: '', data: '7-Zip.vhdx', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.wim', value: '', data: '7-Zip.wim', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.xar', value: '', data: '7-Zip.xar', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.xz', value: '', data: '7-Zip.xz', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.z', value: '', data: '7-Zip.z', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.zip', value: '', data: '7-Zip.zip', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.001', value: '', data: '001 Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.001\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,9', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.001\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.7z', value: '', data: '7z Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.7z\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,0', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.7z\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.apfs', value: '', data: 'apfs Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.apfs\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,25', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.apfs\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.arj', value: '', data: 'arj Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.arj\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,4', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.arj\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.bz2', value: '', data: 'bz2 Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.bz2\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,2', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.bz2\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.bzip2', value: '', data: 'bzip2 Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.bzip2\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,2', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.bzip2\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.cab', value: '', data: 'cab Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.cab\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,7', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.cab\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.cpio', value: '', data: 'cpio Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.cpio\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,12', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.cpio\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.deb', value: '', data: 'deb Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.deb\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,11', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.deb\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.dmg', value: '', data: 'dmg Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.dmg\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,17', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.dmg\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.esd', value: '', data: 'esd Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.esd\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,15', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.esd\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.fat', value: '', data: 'fat Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.fat\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,21', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.fat\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.gz', value: '', data: 'gz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.gz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,14', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.gz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.gzip', value: '', data: 'gzip Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.gzip\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,14', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.gzip\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.hfs', value: '', data: 'hfs Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.hfs\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,18', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.hfs\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.iso', value: '', data: 'iso Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.iso\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,8', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.iso\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lha', value: '', data: 'lha Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lha\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,6', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lha\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lzh', value: '', data: 'lzh Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lzh\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,6', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lzh\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lzma', value: '', data: 'lzma Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lzma\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,16', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.lzma\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.ntfs', value: '', data: 'ntfs Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.ntfs\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,22', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.ntfs\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.rar', value: '', data: 'rar Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.rar\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,3', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.rar\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.rpm', value: '', data: 'rpm Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.rpm\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,10', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.rpm\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.squashfs', value: '', data: 'squashfs Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.squashfs\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,24', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.squashfs\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.swm', value: '', data: 'swm Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.swm\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,15', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.swm\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tar', value: '', data: 'tar Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tar\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,13', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tar\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.taz', value: '', data: 'taz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.taz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,5', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.taz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tbz', value: '', data: 'tbz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tbz2', value: '', data: 'tbz2 Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tbz2\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,2', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tbz2\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tbz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,2', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tbz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tgz', value: '', data: 'tgz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tgz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,14', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tgz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tpz', value: '', data: 'tpz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tpz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,14', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.tpz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.txz', value: '', data: 'txz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.txz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,23', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.txz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.vhd', value: '', data: 'vhd Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.vhd\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,20', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.vhd\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.vhdx', value: '', data: 'vhdx Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.vhdx\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,20', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.vhdx\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.wim', value: '', data: 'wim Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.wim\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,15', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.wim\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.xar', value: '', data: 'xar Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.xar\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,19', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.xar\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.xz', value: '', data: 'xz Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.xz\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,23', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.xz\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.z', value: '', data: 'z Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.z\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,5', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.z\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.zip', value: '', data: 'zip Archive', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.zip\DefaultIcon', value: '', data: 'C:\Program Files\7-Zip\7z.dll,1', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\7-Zip.zip\shell\open\command', value: '', data: '"C:\Program Files\7-Zip\7zFM.exe" "%1"', type: REG_SZ}

  ################ END NO LOCAL BUILD ################

  - !file:
    path: 'C:\Windows\SoftwareDistribution'
    weight: 20
    ignoreErrors: true
